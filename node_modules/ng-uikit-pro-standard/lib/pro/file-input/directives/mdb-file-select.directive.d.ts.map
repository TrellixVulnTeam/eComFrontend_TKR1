{"version":3,"file":"mdb-file-select.directive.d.ts","sources":["../../../../../../projects/ng-uikit-pro-standard/src/lib/pro/file-input/directives/mdb-file-select.directive.ts"],"names":[],"mappings":"AAAA,OAAO,EACL,UAAU,EACV,YAAY,EAGZ,MAAM,EACN,SAAS,EAKV,MAAM,eAAe,CAAC;AAEvB,OAAO,EAAE,kBAAkB,EAAE,YAAY,EAAE,MAAM,+BAA+B,CAAC;AACjF,OAAO,EAAE,eAAe,EAAE,MAAM,+BAA+B,CAAC;;AAIhE,qBAQa,sBAAuB,YAAW,MAAM,EAAE,SAAS;AAChE,IAWmC,OAAO,CAAC,WAAW;AAAE,IAAK,OAAO,CAAC,UAAU;AAAE,IAXtE,WAAW,EAAE,YAAY,CAAC,GAAG,CAAC,CAAC;AAC1C,IAAW,OAAO,EAAE,eAAe,CAAC;AACpC,IAAY,YAAY,EAAE,YAAY,CAAC,YAAY,CAAC,CAAC;AACrD,IACE,OAAO,CAAC,SAAS,CAAgC;AACnD,IACE,MAAM,EAAE,kBAAkB,CAAC;AAC7B,IAAE,QAAQ,EAAE,OAAO,CAAsC;AACzD,IACE,EAAE,EAAE,gBAAgB,GAAG,GAAG,CAAC;AAC7B,gBAC2C,WAAW,EAAE,GAAG,EAAU,UAAU,EAAE,UAAU;AAAG,IAI5F,QAAQ;AACL,IAqBH,WAAW;AACR,IAgBH,YAAY,aAGV;;;AACJ,CAAC;AACD","sourcesContent":["import {\n  ElementRef,\n  EventEmitter,\n  Input,\n  Output,\n  OnInit,\n  OnDestroy,\n  PLATFORM_ID,\n  Inject,\n  ViewEncapsulation,\n  Component,\n} from '@angular/core';\nimport { isPlatformServer } from '@angular/common';\nimport { MDBUploaderService, UploadOutput } from '../classes/mdb-uploader.class';\nimport { UploaderOptions } from '../classes/mdb-uploader.class';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n  // tslint:disable-next-line:component-selector\n  selector: '[mdbFileSelect]',\n  template: '<ng-content></ng-content>',\n  styleUrls: ['./../file-input-module.scss'],\n  encapsulation: ViewEncapsulation.None,\n})\n// tslint:disable-next-line:component-class-suffix\nexport class MDBFileSelectDirective implements OnInit, OnDestroy {\n  @Input() uploadInput: EventEmitter<any>;\n  @Input() options: UploaderOptions;\n  @Output() uploadOutput: EventEmitter<UploadOutput>;\n\n  private _destroy$: Subject<void> = new Subject();\n\n  upload: MDBUploaderService;\n  isServer: boolean = isPlatformServer(this.platform_id);\n  // el: HTMLInputElement;\n  el: HTMLInputElement | any;\n\n  constructor(@Inject(PLATFORM_ID) private platform_id: any, private elementRef: ElementRef) {\n    this.uploadOutput = new EventEmitter<UploadOutput>();\n  }\n\n  ngOnInit() {\n    if (this.isServer) {\n      return;\n    }\n\n    const concurrency = (this.options && this.options.concurrency) || Number.POSITIVE_INFINITY;\n    const allowedContentTypes = (this.options && this.options.allowedContentTypes) || ['*'];\n    const maxUploads = (this.options && this.options.maxUploads) || Number.POSITIVE_INFINITY;\n    this.upload = new MDBUploaderService(concurrency, allowedContentTypes, maxUploads);\n\n    this.el = this.elementRef.nativeElement;\n    this.el.addEventListener('change', this.fileListener, false);\n\n    this.upload.serviceEvents.pipe(takeUntil(this._destroy$)).subscribe((event: UploadOutput) => {\n      this.uploadOutput.emit(event);\n    });\n\n    if (this.uploadInput instanceof EventEmitter) {\n      this.upload.initInputEvents(this.uploadInput);\n    }\n  }\n\n  ngOnDestroy() {\n    if (this.isServer) {\n      return;\n    }\n\n    if (this.el) {\n      this.el.removeEventListener('change', this.fileListener, false);\n    }\n\n    if (this.uploadInput) {\n      this.uploadInput.unsubscribe();\n    }\n\n    this._destroy$.next();\n    this._destroy$.complete();\n  }\n\n  fileListener = () => {\n    this.upload.handleFiles(this.el.files);\n    this.el.value = '';\n  };\n}\n"]}