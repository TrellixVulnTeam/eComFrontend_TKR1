{"version":3,"file":"tree-view.component.d.ts","sources":["../../../../../projects/ng-uikit-pro-standard/src/lib/pro/tree-view/tree-view.component.ts"],"names":[],"mappings":"AAAA,OAAO,EAIL,YAAY,EACZ,MAAM,EAGN,iBAAiB,EAElB,MAAM,eAAe,CAAC;;AAGvB,qBAQa,gBAAiB,YAAW,MAAM;AAC/C,IAsBc,OAAO,CAAC,MAAM;AAAE,IApB5B,OAAO,oBAAsB;AAC/B,IAAY,WAAW,oBAAsB;AAC7C,IAAY,YAAY,oBAAsB;AAC9C,IAAW,KAAK,EAAE,GAAG,CAAC;AACtB,IAAW,SAAS,EAAE,MAAM,CAAC;AAC7B,IAAW,aAAa,EAAE,MAAM,CAAC;AACjC,IAAW,eAAe,EAAE,MAAM,CAAC;AACnC,IAAE,IAAa,SAAS,CAAC,KAAK,EAAE,OAAO,EAKpC;AACH,IAAW,UAAU,UAAS;AAC9B,IAAW,kBAAkB,UAAS;AACtC,IACE,OAAO,CAAC,UAAU,CAAS;AAC7B,IAAE,aAAa,EAAE,MAAM,EAAE,CAAM;AAC/B,IAAE,MAAM,EAAE,GAAG,CAAM;AACnB,gBACsB,MAAM,EAAE,iBAAiB;AAAG,IAEhD,QAAQ;AACL,IAKH,eAAe;AACZ,IAOH,cAAc;AACX,IASH,aAAa;AACV,IASH,OAAO,CAAC,kBAAkB;AAAE,IAU5B,OAAO,CAAC,iBAAiB;AAAE,IAU3B,OAAO,CAAC,sBAAsB;AAAE,IAYhC,OAAO,CAAC,8BAA8B;AAAE,IAaxC,YAAY,CAAC,CAAC,EAAE,MAAM;AACnB,IAcH,OAAO,CAAC,qBAAqB;AAAE,IAkB/B,iBAAiB,CAAC,CAAC,EAAE,aAAa,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,MAAM;AACrD,IAQH,SAAS,CAAC,CAAC,EAAE,aAAa,EAAE,CAAC,EAAE,MAAM;AAClC,IAOH,UAAU,CAAC,IAAI,EAAE,GAAG;AACjB,IAYH,OAAO,CAAC,gBAAgB;AAAE,IAa1B,wBAAwB,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM;AAC5C,IAkBH,OAAO,CAAC,8BAA8B;;;AAAE,CAkBzC;AACD","sourcesContent":["import {\n  Component,\n  Input,\n  Output,\n  EventEmitter,\n  OnInit,\n  ViewEncapsulation,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  HostBinding,\n} from '@angular/core';\n\nimport { SPACE, ENTER } from '../../free/utils/keyboard-navigation';\n@Component({\n  // tslint:disable-next-line: component-selector\n  selector: 'mdb-tree',\n  templateUrl: './tree-view.component.html',\n  styleUrls: ['./tree-view.component.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class MdbTreeComponent implements OnInit {\n  @HostBinding('class.mdb-tree')\n  @Output()\n  checked = new EventEmitter();\n  @Output() checkedKeys = new EventEmitter();\n  @Output() nodesChanged = new EventEmitter();\n  @Input() nodes: any;\n  @Input() textField: string;\n  @Input() childrenField: string;\n  @Input() checkboxesField: string;\n  @Input() set expandAll(value: boolean) {\n    if (this.nodes && this.nodes.entries()) {\n      this._expandAll = value;\n      this.toggleExpandAll();\n    }\n  }\n  @Input() checkboxes = false;\n  @Input() toggleOnTitleClick = false;\n\n  private _expandAll = false;\n  checkedValues: string[] = [];\n  toggle: any = {};\n\n  constructor(private _cdRef: ChangeDetectorRef) {}\n\n  ngOnInit() {\n    if (this.nodes && this.nodes.entries()) {\n      this._setInitialCheckedKeys();\n    }\n  }\n\n  toggleExpandAll() {\n    if (this._expandAll) {\n      this.expandAllNodes();\n    } else if (!this._expandAll) {\n      this.closeAllNodes();\n    }\n  }\n\n  expandAllNodes() {\n    for (const [index, node] of this.nodes.entries()) {\n      const idx = index;\n      this.toggle[idx] = true;\n      if (node[this.childrenField] && node[this.childrenField].length > 0) {\n        this._expandAllChildren(node, idx);\n      }\n    }\n  }\n\n  closeAllNodes() {\n    for (const [index, node] of this.nodes.entries()) {\n      const idx = index;\n      this.toggle[idx] = false;\n      if (node[this.childrenField] && node[this.childrenField].length > 0) {\n        this._closeAllChildren(node, idx);\n      }\n    }\n  }\n\n  private _expandAllChildren(node: any, idx: string) {\n    for (const [childIndex, childNode] of node[this.childrenField].entries()) {\n      const childIdx = idx + '_' + childIndex;\n      this.toggle[childIdx] = true;\n      if (childNode[this.childrenField] && childNode[this.childrenField].length > 0) {\n        this._expandAllChildren(childNode, childIdx);\n      }\n    }\n  }\n\n  private _closeAllChildren(node: any, idx: string) {\n    for (const [childIndex, childNode] of node[this.childrenField].entries()) {\n      const childIdx = idx + '_' + childIndex;\n      this.toggle[childIdx] = false;\n      if (childNode[this.childrenField] && childNode[this.childrenField].length > 0) {\n        this._closeAllChildren(childNode, childIdx);\n      }\n    }\n  }\n\n  private _setInitialCheckedKeys() {\n    for (const [index, node] of this.nodes.entries()) {\n      if (node[this.checkboxesField]) {\n        const idx = index;\n        this.checkedValues.push(idx);\n        if (node[this.childrenField] && node[this.childrenField].length > 0) {\n          this._hasInitialCheckedKeysChildren(node[this.childrenField], idx);\n        }\n      }\n    }\n  }\n\n  private _hasInitialCheckedKeysChildren(childrenNode: any, i: string) {\n    for (const [childrenIdx, node] of childrenNode.entries()) {\n      const idx = childrenIdx + '_' + i;\n\n      if (node[this.checkboxesField]) {\n        this.checkedValues.push(idx);\n      }\n      if (node[this.childrenField] && node[this.childrenField].length > 0) {\n        this._hasInitialCheckedKeysChildren(node[this.childrenField], idx);\n      }\n    }\n  }\n\n  toggleByNode(i: string) {\n    for (const [index, node] of this.nodes.entries()) {\n      if (node[this.childrenField] && node[this.childrenField].length > 0) {\n        const idx = index;\n        const toggleIdx = i;\n        if (idx === toggleIdx) {\n          this.toggle[idx] = !this.toggle[idx];\n          this._cdRef.markForCheck();\n        } else {\n          this._childrenToggleByNode(node, idx, toggleIdx);\n        }\n      }\n    }\n  }\n\n  private _childrenToggleByNode(node: any, i: string, toggleIdx: string) {\n    for (const [childIndex, childNode] of node[this.childrenField].entries()) {\n      const nodeHasChildren =\n        childNode[this.childrenField] && childNode[this.childrenField].length > 0;\n      if (nodeHasChildren) {\n        const idx = i + '_' + childIndex;\n        if (idx === toggleIdx) {\n          this.toggle[idx] = !this.toggle[idx];\n          this._cdRef.markForCheck();\n        } else {\n          this._childrenToggleByNode(childNode, idx, toggleIdx);\n        }\n      } else {\n        return;\n      }\n    }\n  }\n\n  onKeydownCheckbox(e: KeyboardEvent, node: any, i: string) {\n    // tslint:disable-next-line: deprecation\n    if (e.keyCode === SPACE || e.keyCode === ENTER) {\n      e.preventDefault();\n      this.checkNodes(node);\n      this.updateNodesCheckedValues(node, i);\n    }\n  }\n\n  onKeydown(e: KeyboardEvent, i: string) {\n    // tslint:disable-next-line: deprecation\n    if (e.keyCode === SPACE || e.keyCode === ENTER) {\n      e.preventDefault();\n      this.toggle[i] = !this.toggle[i];\n    }\n  }\n\n  checkNodes(node: any) {\n    setTimeout(() => {\n      node[this.checkboxesField] = !node[this.checkboxesField];\n      this.checked.emit(node);\n      this.nodesChanged.emit(this.nodes);\n    }, 0);\n    const nodeHasChildren = node[this.childrenField] && node[this.childrenField].length > 0;\n    if (nodeHasChildren) {\n      this._checkChildNodes(node[this.childrenField], !node[this.checkboxesField]);\n    }\n    this._cdRef.markForCheck();\n  }\n\n  private _checkChildNodes(children: any, checked: boolean) {\n    children.forEach((childNode: any) => {\n      if (childNode[this.checkboxesField] !== undefined) {\n        childNode[this.checkboxesField] = checked;\n        const nodeHasChildren =\n          childNode[this.childrenField] && childNode[this.childrenField].length > 0;\n        if (nodeHasChildren) {\n          this._checkChildNodes(childNode[this.childrenField], checked);\n        }\n      }\n    });\n  }\n\n  updateNodesCheckedValues(node: any, idx: string) {\n    setTimeout(() => {\n      if (node[this.checkboxesField] && !this.checkedValues.includes(idx)) {\n        this.checkedValues.push(idx);\n      } else if (!node[this.checkboxesField] && this.checkedValues.includes(idx)) {\n        const removeIndex = this.checkedValues.findIndex(e => e === idx);\n\n        if (removeIndex !== -1) {\n          this.checkedValues.splice(removeIndex, 1);\n        }\n      }\n      const nodeHasChildren = node[this.childrenField] && node[this.childrenField].length > 0;\n      if (nodeHasChildren) {\n        this._updateChildNodesCheckedValues(node[this.childrenField], idx);\n      }\n      this.checkedKeys.emit(this.checkedValues);\n    }, 0);\n  }\n\n  private _updateChildNodesCheckedValues(childrenNode: any, childrenIdx: string) {\n    for (const [index, node] of childrenNode.entries()) {\n      const idx = childrenIdx + '_' + index;\n\n      if (node[this.checkboxesField] && !this.checkedValues.includes(idx)) {\n        this.checkedValues.push(idx);\n      } else if (!node[this.checkboxesField] && this.checkedValues.includes(idx)) {\n        const removeIndex = this.checkedValues.findIndex(e => e === idx);\n        if (removeIndex !== -1) {\n          this.checkedValues.splice(removeIndex, 1);\n        }\n      }\n      const nodeHasChildren = node[this.childrenField] && node[this.childrenField].length > 0;\n      if (nodeHasChildren) {\n        this._updateChildNodesCheckedValues(node[this.childrenField], idx);\n      }\n    }\n  }\n}\n"]}