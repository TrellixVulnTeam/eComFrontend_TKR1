{"version":3,"file":"calendar-tooltip.directive.js","sources":["../../../src/modules/common/calendar-tooltip.directive.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Directive,\n  Component,\n  HostListener,\n  OnDestroy,\n  Input,\n  ComponentRef,\n  Injector,\n  ComponentFactoryResolver,\n  ViewContainerRef,\n  ElementRef,\n  ComponentFactory,\n  Inject,\n  Renderer2,\n  TemplateRef\n} from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { Positioning } from 'positioning';\nimport { CalendarEvent } from 'calendar-utils';\n\n@Component({\n  template: `\n    <ng-template\n      #defaultTemplate\n      let-contents=\"contents\"\n      let-placement=\"placement\"\n      let-event=\"event\">\n      <div class=\"cal-tooltip\" [ngClass]=\"'cal-tooltip-' + placement\">\n        <div class=\"cal-tooltip-arrow\"></div>\n        <div class=\"cal-tooltip-inner\" [innerHtml]=\"contents\"></div>\n      </div>\n    </ng-template>\n    <ng-template\n      [ngTemplateOutlet]=\"customTemplate || defaultTemplate\"\n      [ngTemplateOutletContext]=\"{\n        contents: contents,\n        placement: placement,\n        event: event\n      }\">\n    </ng-template>\n  `\n})\nexport class CalendarTooltipWindowComponent {\n  @Input() contents: string;\n\n  @Input() placement: string;\n\n  @Input() event: CalendarEvent;\n\n  @Input() customTemplate: TemplateRef<any>;\n}\n\n@Directive({\n  selector: '[mwlCalendarTooltip]'\n})\nexport class CalendarTooltipDirective implements OnDestroy {\n  @Input('mwlCalendarTooltip') contents: string; // tslint:disable-line no-input-rename\n\n  @Input('tooltipPlacement') placement: string = 'top'; // tslint:disable-line no-input-rename\n\n  @Input('tooltipTemplate') customTemplate: TemplateRef<any>; // tslint:disable-line no-input-rename\n\n  @Input('tooltipEvent') event: CalendarEvent; // tslint:disable-line no-input-rename\n\n  @Input('tooltipAppendToBody') appendToBody: boolean; // tslint:disable-line no-input-rename\n\n  private tooltipFactory: ComponentFactory<CalendarTooltipWindowComponent>;\n  private tooltipRef: ComponentRef<CalendarTooltipWindowComponent>;\n  private positioning: Positioning = new Positioning();\n\n  constructor(\n    private elementRef: ElementRef,\n    private injector: Injector,\n    private renderer: Renderer2,\n    componentFactoryResolver: ComponentFactoryResolver,\n    private viewContainerRef: ViewContainerRef,\n    @Inject(DOCUMENT) private document //tslint:disable-line\n  ) {\n    this.tooltipFactory = componentFactoryResolver.resolveComponentFactory(\n      CalendarTooltipWindowComponent\n    );\n  }\n\n  ngOnDestroy(): void {\n    this.hide();\n  }\n\n  @HostListener('mouseenter')\n  onMouseOver(): void {\n    this.show();\n  }\n\n  @HostListener('mouseleave')\n  onMouseOut(): void {\n    this.hide();\n  }\n\n  private show(): void {\n    if (!this.tooltipRef && this.contents) {\n      this.tooltipRef = this.viewContainerRef.createComponent(\n        this.tooltipFactory,\n        0,\n        this.injector,\n        []\n      );\n      this.tooltipRef.instance.contents = this.contents;\n      this.tooltipRef.instance.placement = this.placement;\n      this.tooltipRef.instance.customTemplate = this.customTemplate;\n      this.tooltipRef.instance.event = this.event;\n      if (this.appendToBody) {\n        this.document.body.appendChild(this.tooltipRef.location.nativeElement);\n      }\n      requestAnimationFrame(() => {\n        this.positionTooltip();\n      });\n    }\n  }\n\n  private hide(): void {\n    if (this.tooltipRef) {\n      this.viewContainerRef.remove(\n        this.viewContainerRef.indexOf(this.tooltipRef.hostView)\n      );\n      this.tooltipRef = null;\n    }\n  }\n\n  private positionTooltip(): void {\n    if (this.tooltipRef) {\n      const targetPosition: ClientRect = this.positioning.positionElements(\n        this.elementRef.nativeElement,\n        this.tooltipRef.location.nativeElement.children[0],\n        this.placement,\n        this.appendToBody\n      );\n\n      const elm: HTMLElement = this.tooltipRef.location.nativeElement\n        .children[0];\n\n      this.renderer.setStyle(elm, 'top', `${targetPosition.top}px`);\n      this.renderer.setStyle(elm, 'left', `${targetPosition.left}px`);\n    }\n  }\n}\n"]}